# Default configuration for tcm-piv
#
# Notes:
# - This file is packaged with the library and provides fallbacks.
# - User configs override these values.
# - Per-pass parameters may be a scalar (broadcast) or a list of length `nr_passes`.
#
# Maintenance:
# - Treat this file as the single source of truth for defaults.
#   The Python loader merges user config over these defaults and should not
#   duplicate defaults in code.
# - Keep tables only one level deep (e.g. `[section] key = value`).
# - TOML has no `null`. Use empty string "" as “not provided” for optional paths.
# - For “tuple-like” values, use arrays like `[w, h]`; for per-pass tuple values,
#   use arrays-of-arrays like `[[w, h], [w2, h2], ...]`.

nr_passes = 1

[source]
image_dir = ""
output_dir = ""
frames_to_use = "all"  # "all" or array of ints
extra_vel_dim_m = 0.01

[camera]
camera_dir = ""
calib_dir = ""
calib_spacing_mm = 1.0

[preprocessing]
# Per-pass
# downsample_factor = 1
# downsample_factor = [4, 1, 1]
downsample_factor = 1

# Empty string means: not provided
background_dir = ""

# (y_start, y_end, x_start, x_end)
# y_end/x_end: 0 means full extent; negative means offset from end.
crop_roi = [0, 0, 0, 0]

[correlation]
# Per-pass
corrs_to_sum = 1
# Number of interrogation windows as [n_y, n_x]
nr_windows = [1, 1]        # or [[n_y, n_x], [n_y2, n_x2], ...]
window_overlap = 0.0       # 0..1

[displacement]
# Per-pass
nr_peaks = 1
min_peak_distance = 5

[postprocessing]
# Per-pass
neighbourhood_size = [3, 3, 3]

# Global outlier filter mode passed to `tcm_piv.postprocessing.filter_outliers`.
# Allowed: "semicircle_rect", "circle".
outlier_filter_mode = "semicircle_rect"
max_velocity = [75.0, 10.0]

# Which in-plane velocity component represents the flow direction.
# Used by the final flow-rate export.
# Allowed: "x" (use vx) or "y" (use vy).
flow_direction = "x"

# Per-pass; element can be int or [thr_y, thr_x]
neighbourhood_threshold = 1

time_smoothing_lambda = 0.0

[visualisation]
plot_model = false
model_gender = "male"
model_mass = 70.0
model_height = 1.93
plot_global_filters = false
plot_window_layout = false
plot_flow_rate = false
export_velocity_profiles_pdf = false
